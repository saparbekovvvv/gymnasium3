{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/redux/api/fond/index.ts"],"sourcesContent":["import { api as index } from \"..\";\r\n\r\nconst ENDPOINTS = process.env.NEXT_PUBLIC_ENDPOINT;\r\n\r\n// Функция для получения CSRF токена из cookie\r\nfunction getCsrfToken() {\r\n  const name = \"csrftoken=\";\r\n  const decodedCookie = decodeURIComponent(document.cookie);\r\n  const cookieArray = decodedCookie.split(\";\");\r\n  for (let i = 0; i < cookieArray.length; i++) {\r\n    let cookie = cookieArray[i].trim();\r\n    if (cookie.indexOf(name) === 0) {\r\n      return cookie.substring(name.length, cookie.length);\r\n    }\r\n  }\r\n  return \"\";\r\n}\r\n\r\nconst api = index.injectEndpoints({\r\n  endpoints: (build) => ({\r\n    getFond: build.query<DONATIONS.GetFondResponse, DONATIONS.GetFondRequest>({\r\n      query: () => ({\r\n        url: `${ENDPOINTS}/donations/`,\r\n        method: \"GET\",\r\n      }),\r\n      providesTags: [\"donations\"],\r\n    }),\r\n    postDonations: build.mutation<DONATIONS.CreateDonationResponse, FormData>({\r\n      query: (data) => {\r\n        console.log(\"postDonations called with data:\", {\r\n          amount: data.get(\"amount\"),\r\n          comment: data.get(\"comment\"),\r\n          file: data.get(\"confirmation_file\"),\r\n        });\r\n\r\n        return {\r\n          url: `${ENDPOINTS}/donations/`,\r\n          method: \"POST\",\r\n          body: data,\r\n          headers: {\r\n            \"X-CSRFToken\": getCsrfToken(),\r\n          },\r\n        };\r\n      },\r\n      invalidatesTags: [\"donations\"],\r\n    }),\r\n  }),\r\n});\r\n\r\nexport const { useGetFondQuery, usePostDonationsMutation } = api;\r\n"],"names":[],"mappings":";;;;;;;AAEA,MAAM;AAEN,8CAA8C;AAC9C,SAAS;IACP,MAAM,OAAO;IACb,MAAM,gBAAgB,mBAAmB,SAAS,MAAM;IACxD,MAAM,cAAc,cAAc,KAAK,CAAC;IACxC,IAAK,IAAI,IAAI,GAAG,IAAI,YAAY,MAAM,EAAE,IAAK;QAC3C,IAAI,SAAS,WAAW,CAAC,EAAE,CAAC,IAAI;QAChC,IAAI,OAAO,OAAO,CAAC,UAAU,GAAG;YAC9B,OAAO,OAAO,SAAS,CAAC,KAAK,MAAM,EAAE,OAAO,MAAM;QACpD;IACF;IACA,OAAO;AACT;AAEA,MAAM,MAAM,4HAAA,CAAA,MAAK,CAAC,eAAe,CAAC;IAChC,WAAW,CAAC,QAAU,CAAC;YACrB,SAAS,MAAM,KAAK,CAAsD;gBACxE,OAAO,IAAM,CAAC;wBACZ,KAAK,CAAC,EAAE,UAAU,WAAW,CAAC;wBAC9B,QAAQ;oBACV,CAAC;gBACD,cAAc;oBAAC;iBAAY;YAC7B;YACA,eAAe,MAAM,QAAQ,CAA6C;gBACxE,OAAO,CAAC;oBACN,QAAQ,GAAG,CAAC,mCAAmC;wBAC7C,QAAQ,KAAK,GAAG,CAAC;wBACjB,SAAS,KAAK,GAAG,CAAC;wBAClB,MAAM,KAAK,GAAG,CAAC;oBACjB;oBAEA,OAAO;wBACL,KAAK,CAAC,EAAE,UAAU,WAAW,CAAC;wBAC9B,QAAQ;wBACR,MAAM;wBACN,SAAS;4BACP,eAAe;wBACjB;oBACF;gBACF;gBACA,iBAAiB;oBAAC;iBAAY;YAChC;QACF,CAAC;AACH;AAEO,MAAM,EAAE,eAAe,EAAE,wBAAwB,EAAE,GAAG"}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/appPages/site/components/pages/fond/DonationContent/DonationContent.module.scss.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_export_value__({\n  \"content\": \"DonationContent-module-scss-module__QxzTRW__content\",\n  \"donationContent\": \"DonationContent-module-scss-module__QxzTRW__donationContent\",\n  \"error\": \"DonationContent-module-scss-module__QxzTRW__error\",\n  \"fileButton\": \"DonationContent-module-scss-module__QxzTRW__fileButton\",\n  \"formGroup\": \"DonationContent-module-scss-module__QxzTRW__formGroup\",\n  \"heading\": \"DonationContent-module-scss-module__QxzTRW__heading\",\n  \"input\": \"DonationContent-module-scss-module__QxzTRW__input\",\n  \"label\": \"DonationContent-module-scss-module__QxzTRW__label\",\n  \"shake\": \"DonationContent-module-scss-module__QxzTRW__shake\",\n  \"submitButton\": \"DonationContent-module-scss-module__QxzTRW__submitButton\",\n  \"textarea\": \"DonationContent-module-scss-module__QxzTRW__textarea\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/src/appPages/site/components/pages/fond/DonationContent/DonationContent.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { usePostDonationsMutation } from \"@/redux/api/fond\";\r\nimport { SubmitHandler, useForm } from \"react-hook-form\";\r\nimport styles from \"./DonationContent.module.scss\";\r\n\r\ninterface CreateDonationRequest {\r\n  amount: number;\r\n  confirmation_file: FileList;\r\n  comment?: string;\r\n}\r\n\r\ninterface ErrorWithResponse extends Error {\r\n  response?: {\r\n    data?: any;\r\n    status?: number;\r\n    headers?: any;\r\n  };\r\n}\r\n\r\nconst DonationContent: React.FC = () => {\r\n  const [postDonationsMutation] = usePostDonationsMutation();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [selectedFileName, setSelectedFileName] = useState<string | null>(null);\r\n  const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    formState: { errors },\r\n    watch,\r\n  } = useForm<CreateDonationRequest>();\r\n\r\n  const watchFile = watch(\"confirmation_file\");\r\n\r\n  useEffect(() => {\r\n    fetch(`${process.env.NEXT_PUBLIC_ENDPOINT}/csrf/`, {\r\n      credentials: 'include',\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (watchFile && watchFile.length > 0) {\r\n      setSelectedFileName(watchFile[0].name);\r\n    } else {\r\n      setSelectedFileName(null);\r\n    }\r\n  }, [watchFile]);\r\n\r\n  const onSubmit: SubmitHandler<CreateDonationRequest> = async (data) => {\r\n    console.log(\"onSubmit called with data:\", data);\r\n    setIsLoading(true);\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"amount\", data.amount.toString());\r\n\r\n    const file = data.confirmation_file[0];\r\n    if (file) {\r\n      console.log(\"File type:\", file.type);\r\n      if (file.type !== 'application/pdf') {\r\n        alert(\"Пожалуйста, выберите файл в формате PDF.\");\r\n        setIsLoading(false);\r\n        return;\r\n      }\r\n      formData.append(\"confirmation_file\", file);\r\n    } else {\r\n      console.error(\"No file selected\");\r\n      alert(\"Пожалуйста, выберите файл.\");\r\n      setIsLoading(false);\r\n      return;\r\n    }\r\n\r\n    if (data.comment) {\r\n      formData.append(\"comment\", data.comment);\r\n    }\r\n\r\n    console.log(\"FormData contents:\");\r\n    formData.forEach((value, key) => {\r\n      console.log(key, value);\r\n    });\r\n\r\n    try {\r\n      const result = await postDonationsMutation(formData).unwrap();\r\n      console.log(\"API response:\", result);\r\n      alert(\"Пожертвование успешно отправлено!\");\r\n    } catch (error) {\r\n      console.error(\"Full error object:\", error);\r\n      if (error && typeof error === 'object' && 'response' in error) {\r\n        const errorWithResponse = error as ErrorWithResponse;\r\n        if (errorWithResponse.response) {\r\n          console.error(\"Response data:\", errorWithResponse.response.data);\r\n          console.error(\"Response status:\", errorWithResponse.response.status);\r\n          console.error(\"Response headers:\", errorWithResponse.response.headers);\r\n        }\r\n      }\r\n      console.error(\"Error sending donation:\", error);\r\n      alert(\"Произошла ошибка при отправке пожертвования. Пожалуйста, попробуйте еще раз.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFileButtonClick = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  return (\r\n    <div className={styles.donationContent}>\r\n      <div className={styles.content}>\r\n        <h2 className={styles.heading}>Сделать пожертвование</h2>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n          <div className={styles.formGroup}>\r\n            <label className={styles.label} htmlFor=\"amount\">Сумма (сом):</label>\r\n            <input\r\n              className={styles.input}\r\n              type=\"number\"\r\n              id=\"amount\"\r\n              step=\"0.01\"\r\n              {...register(\"amount\", {\r\n                required: \"Сумма обязательна\",\r\n                min: { value: 0.01, message: \"Сумма должна быть больше 0\" },\r\n                validate: (value) => !isNaN(value) || \"Введите корректное число\"\r\n              })}\r\n            />\r\n            {errors.amount && (\r\n              <span className={styles.error}>{errors.amount.message}</span>\r\n            )}\r\n          </div>\r\n\r\n          <div className={styles.formGroup}>\r\n            <label className={styles.label} htmlFor=\"confirmation_file\">Квитанция о переводе (только PDF):</label>\r\n            <input\r\n              type=\"file\"\r\n              id=\"confirmation_file\"\r\n              accept=\".pdf\"\r\n              style={{ display: 'none' }}\r\n              {...register(\"confirmation_file\", {\r\n                required: \"Файл обязателен\",\r\n              })}\r\n              ref={(e) => {\r\n                register(\"confirmation_file\").ref(e);\r\n                fileInputRef.current = e;\r\n              }}\r\n            />\r\n            <button type=\"button\" onClick={handleFileButtonClick} className={styles.fileButton}>\r\n              {selectedFileName || \"Выберите файл\"}\r\n            </button>\r\n            {errors.confirmation_file && (\r\n              <span className={styles.error}>\r\n                {errors.confirmation_file.message}\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          <div className={styles.formGroup}>\r\n            <label className={styles.label} htmlFor=\"comment\">Комментарий:</label>\r\n            <textarea className={styles.textarea} id=\"comment\" {...register(\"comment\")} />\r\n          </div>\r\n\r\n          <button type=\"submit\" className={styles.submitButton} disabled={isLoading}>\r\n            {isLoading ? 'Отправка...' : 'Отправить'}\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DonationContent;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}